{"version":3,"sources":["Svg/JNode.js","Svg/JSVG.js","Svg/JSprite.js"],"names":["JNode","nodeName","_classCallCheck","this","$node","$","document","createElementNS","position","x","y","attr","k","v","JSVG","svg","_named_sprites","$svg","discoverStructure","root","JSprite","setStage","need_refresh","setFramerate","setTickrate","event","params","trigger","event_name","listener","on","fps","self","clearInterval","tick_interval","interval_ms","lastTick","performance","now","tick","time_ratio","setInterval","onEnterFrame","refresh","window","requestAnimationFrame","fps_interval","l","h","child","addChild","find","each","discoverSprite","name","data","sprite","removeAttr","pivotX","pivotY","setPivot","sprite_name","JKeyboard","left","right","up","down","esc","enter","space","keys","e","which","preventDefault","stopPropagation","JRect","w","_this","_possibleConstructorReturn","__proto__","Object","getPrototypeOf","call","width","height","$node_origin","nowrap","wrap","parent","addClass","_children","_position","z","_rotation","_pivotMove","_scale","shortRotation","rotationForceDirection","_tween_rotation","_tween_position","needRefresh","clone","push","addGraphic","graphic","append","askRefresh","applyTransform","every","round2","num","Math","round","scale_transform","rotate_transform","translate_transform","transform","directional","vitesse","dx","dy","arad","rotation","PI","cos","sin","moveTo","relative","arguments","length","undefined","ease","Quad","easeOut","next_x","next_y","pause","TweenLite","to","ratio","angle","rotateTo","next_rotation","distance","stage","compensation","scale"],"mappings":"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","file":"all.js","sourcesContent":["class JNode {\n    constructor(nodeName) {\n        this.$node = $(document.createElementNS('http://www.w3.org/2000/svg', nodeName));\n        this.position = function (x, y) {\n            this.$node\n                .attr({\n                    x: x,\n                    y: y\n                });\n            return this;\n        };\n    }\n    attr(k, v) {\n        return this.$node.attr(k, v);\n    }\n}\n","class JSVG {\n    constructor(svg) {\n        this._named_sprites=[];\n        if (!svg) {\n            this.$svg = new JNode(\"svg\").$node;\n        } else {\n            this.$svg = svg;\n            this.discoverStructure();\n            //TODO : apprentissage /  découverte\n        }\n        this.root = new JSprite(this.$svg,true);\n        this.root.setStage(this);\n\n        this.need_refresh = false;\n\n        // full speed par défaut\n        this.setFramerate();\n\n        // 100 ticks par seconde par défaut\n        this.setTickrate(100);\n    }\n\n    trigger(event, params) {\n        this.root.$node.trigger(event, params);\n    };\n\n    on(event_name, listener) {\n        this.root.$node.on(event_name, listener);\n    };\n\n    setTickrate(fps) {\n        var self=this;\n        clearInterval(this.tick_interval);\n        var interval_ms = 1000 / fps;\n        var lastTick = performance.now(),\n            tick = function () {\n                var tick = performance.now();\n                var params = [{\n                    time_ratio: (tick - lastTick) / interval_ms\n                }];\n                self.trigger(\"tick\", params);\n                lastTick = tick;\n            };\n        this.tick_interval = setInterval(tick, interval_ms);\n        return this;\n    };\n\n    setFramerate(fps) {\n        this.fps = fps || \"max\";\n        var self = this;\n        var onEnterFrame = function () {\n            //this.dispatchEvent(new Event(\"EnterFrame\",this));\n            if (self.need_refresh) {\n                self.root.refresh();\n                self.need_refresh = false;\n            }\n            if (self.fps == \"max\" && window.requestAnimationFrame) window.requestAnimationFrame(onEnterFrame);\n        };\n\n        clearInterval(this.fps_interval);\n        if (this.fps == \"max\" && window.requestAnimationFrame) window.requestAnimationFrame(onEnterFrame);\n        else {\n            this.fps_interval = setInterval(onEnterFrame, 1000 / this.fps);\n        }  // 50 fps\n        return this;\n\n    };\n\n    askRefresh() {\n        this.need_refresh = true;\n    };\n\n    getRoot() {\n        return this.$svg;\n    };\n\n    setViewBox(x, y, l, h) {\n        this.$svg.attr(\"viewBox\", x + \" \" + y + \" \" + l + \" \" + h);\n        return this;\n    };\n\n    addChild(child) {\n        this.root.addChild(child);\n        return this;\n    };\n\n    discoverStructure() {\n        var self = this;\n        this.$svg.find(\"[data-sprite-name]\").each(function() {\n            self.discoverSprite($(this));\n        })\n    }\n\n    discoverSprite($node) {\n        var name =$node.data(\"sprite-name\");\n        var sprite = new JSprite($node);\n        this._named_sprites[name]=sprite;\n\n        // repositionnement du centre\n        let x=$node.attr(\"x\");\n        if(x) {\n            sprite.x=x;\n            $node.removeAttr(\"x\")\n        }\n        let y=$node.attr(\"y\");\n        if(y) {\n            sprite.y=y;\n            $node.removeAttr(\"y\")\n        }\n\n        let pivotX=$node.data(\"pivot-x\");\n        let pivotY=$node.data(\"pivot-y\");\n        sprite.setPivot(pivotX,pivotY);\n    }\n\n    /**\n     *\n     * @param sprite_name\n     * @returns JSprite\n     */\n    getSpriteByName(sprite_name) {\n        return this._named_sprites[sprite_name];\n    }\n}\n\n\nclass JKeyboard {\n    constructor() {\n        this.left = 37;\n        this.right = 39;\n        this.up = 38;\n        this.down = 40;\n        this.esc = 27;\n        this.enter = 13;\n        this.space = 32;\n        this.keys = [];\n\n        var self = this;\n        $(document).on(\"keydown\", function (e) {\n            self.keys[e.which] = true;\n            if (e.which != 116) {\n                e.preventDefault();\n                e.stopPropagation();\n            }\n\n        }).on(\"keyup\", function (e) {\n            self.keys[e.which] = false;\n        });\n    }\n\n    isDown(which) {\n        return this.keys[which] ? true : false;\n    }\n\n}\n\nclass JRect extends JNode{\n    constructor(x, y, w, h) {\n        super(\"rect\");\n        this.position(x, y)\n            .attr({\n                width: w,\n                height: h\n            });\n    };\n}\n\n","class JSprite {\n    constructor($node_origin, nowrap) {\n        if ($node_origin instanceof JNode) $node_origin = $node_origin.$node;\n        // wrap le noeud\n\n        if (!nowrap) {\n            $node_origin.wrap(document.createElementNS('http://www.w3.org/2000/svg', 'g'));\n            this.$node = $node_origin.parent();\n            this.$node_origin = $node_origin;\n            this.$node_origin.addClass(\"child-node\");\n        } else {\n            this.$node = $node_origin;\n            this.$node_origin = $node_origin.find(\">.child-node\");\n\n        }\n\n        this.root = null;\n\n        this._children = [];\n        this._position = {x: 0, y: 0, z: 0};\n        this._rotation = {x: 0, y: 0, z: 0};\n        this._pivotMove = {x: 0, y: 0, z: 0};\n        this._scale = {x: 1, y: 1, z: 1};\n\n        this.shortRotation = true;\n        this.rotationForceDirection = 0;\n        this._tween_rotation = false;\n        this._tween_position = false;\n\n        this.needRefresh = false;\n    }\n\n    clone() {\n        return new JSprite(this.$node.clone(), true);\n    };\n\n\n    addChild(child) {\n        this._children.push(child);\n        child.setStage(this.root);\n        this.addGraphic(child);\n        return this;\n    }\n\n    addGraphic(graphic) {\n        this.$node.append(graphic.$node)\n    }\n\n    /*\n     gestion de l'affichage\n     */\n    askRefresh() {\n        this.needRefresh = true;\n        if (this.root) {\n            this.root.askRefresh();\n        } else {\n            this.applyTransform();\n        }\n    };\n\n    refresh() {\n        //console.log(\"refresh\",this._children.length);\n        this.applyTransform();\n        this._children.every(function (child) {\n            child.refresh();\n        });\n    };\n\n\n    applyTransform() {\n        if (this.needRefresh) {\n            var round2 = function (num) {\n                return Math.round(num * 100) / 100;\n            };\n            this.needRefresh = false;\n            var scale_transform = \"scale(\" + round2(this._scale.x) + \")\";\n\n            var rotate_transform = \"rotate(\" + round2(this._rotation.z) + \" \" + round2(this._pivotMove.x) + \",\" + round2(this._pivotMove.y) + \")\";\n            //this.$node.attr(\"transform\", rotate_transform);\n\n\n            var x =round2(this._position.x - (this._pivotMove.x * this._scale.x)),\n                y=round2(this._position.y - (this._pivotMove.y * this._scale.y)),\n                translate_transform=\"translate(\"+x+\" \"+y+\")\";\n            //console.log(this.$node,translate_transform + \" \" + scale_transform + \" \" + rotate_transform);\n            this.$node.attr({\n                \"transform\":translate_transform + \" \" + scale_transform + \" \" + rotate_transform\n                //\"x\":x,\n                //\"y\":y\n            });\n        }\n    };\n\n    get x() {\n        return this._position.x;\n    }\n\n    set x(x) {\n        this._position.x = x;\n        this.askRefresh();\n    }\n\n\n    get y() {\n        return this._position.y;\n    }\n\n    set y(y) {\n        this._position.y = y;\n        this.askRefresh();\n    }\n\n    get rotation() {\n        return this._rotation.z;\n    }\n\n    set rotation(angle) {\n        this._rotation.z = angle;\n        this.askRefresh();\n    }\n\n    get scaleX() {\n        return this._scale.x;\n    }\n\n    set scaleX(scale) {\n        this._scale.x = scale;\n        this.askRefresh();\n    }\n\n    get scaleY() {\n        return this._scale.y;\n    }\n\n    set scaleY(scale) {\n        this._scale.y = scale;\n        this.askRefresh();\n    }\n\n    /*\n     public methods pour manipulation\n     */\n    moveOf(x, y, directional, vitesse) {\n        var dx = x, dy = y;\n        if (directional) {\n            var arad = this.rotation * Math.PI / 180;\n            dx = Math.cos(arad) * y + Math.cos(arad + Math.PI / 2) * x;\n            dy = Math.sin(arad) * y + Math.sin(arad + Math.PI / 2) * x;\n            //console.log(\"x,y\",dx,dy);\n        }\n        this.moveTo(this.x + dx, this.y + dy,false,vitesse);\n    };\n\n    moveTo(x, y, relative=false, vitesse=0,ease=Quad.easeOut) {\n        var next_x = x*1,\n            next_y = y*1\n            ;\n\n        if (relative) {\n            next_x += this.x*1;\n            next_y += this.y*1;\n        }\n\n        if (this._tween_position) this._tween_position.pause();\n        this._tween_position = TweenLite.to(this, vitesse, {x: next_x,y:next_y, ease: ease});\n        return this;\n\n    };\n\n    scaleTo(ratio) {\n        this._scale.x = ratio;\n        this._scale.y = ratio;\n        this._scale.z = ratio;\n        return this;\n    };\n\n    rotateOf(angle, vitesse, ease) {\n        return this.rotateTo(angle + this.rotation, vitesse, ease)\n    };\n\n    rotateTo(angle, vitesse=0, ease=Quad.easeOut) {\n\n        var next_rotation = angle%360;\n\n        next_rotation %= 360;\n\n        // shortRotation : évite de tourner à l'envers au tour complet ;)\n        var distance;\n        if (this.rotationForceDirection > 0) {\n            distance = next_rotation - (this.rotation % 360);\n            // ex : 80 -> 70 => diff = -10 => -280 -> 70\n            this.rotation %= 360;\n            if (distance < 0) {\n                next_rotation += 360;\n            }\n        } else if (this.rotationForceDirection < 0) {\n            distance = next_rotation - (this.rotation % 360);\n            // ex : 80 -> 70 => diff = -10 => -280 -> 70\n            this.rotation %= 360;\n            if (distance > 0) {\n                next_rotation -= 360;\n            }\n        } else if (this.shortRotation) {\n            distance = next_rotation - this.rotation;\n            if (distance < -180) {\n                // (on revient en arrière)\n                this.rotation = this.rotation % 360 - 360;\n            } else if (distance > 180) {\n                // ex : 0 -> 270 => diff = 270 => 360 -> 270\n                this.rotation = this.rotation % 360 + 360;\n                // (on retourne)\n            }\n        }\n        if (this._tween_rotation) this._tween_rotation.pause();\n        this._tween_rotation = TweenLite.to(this, vitesse, {rotation: next_rotation, ease: ease});\n        return this;\n//\n    };\n\n    setStage(stage) {\n        this.root = stage;\n        this._children.every(function (child) {\n            child.setStage(stage);\n        })\n    };\n\n    setPivot(x=0, y=0, z=0, compensation=true) {\n        // cast int\n        x*=1;y*=1;z*=1;\n\n        if (compensation) {\n            var dx = x - this._pivotMove.x,\n                dy = y - this._pivotMove.y,\n                dz = z - this._pivotMove.z;\n            this.moveTo(dx, dy, true);\n        }\n\n        this._pivotMove = {x: x, y: y, z: z};\n        //console.log(this._pivotMove);\n        this.askRefresh();                                          // refresh du pivot\n        return this;\n    };\n}\n"]}